define("ps_register",["ps_view","ps_model","ps_popup","ps_language","ps_store","ps_helper","jquery","ps_validator"],function(){var e=arguments[0],r=arguments[1],s=arguments[2],t=arguments[3],i=arguments[4],a=arguments[5],n=arguments[6],o=arguments[7],_={store:new i("ps_register"),form_id:0},u={register_reset:function(){n(".ps_js-register_form").trigger("view_components_fullreset"),_.store.store_exists("info")?_.store.store_update("info",{request_num:_.store.store_fetch("info").request_num+1}):_.store.store_update("info",{request_num:0}),_.store.store_update("info",{loading:!1,validation_id:null}),n(".ps_js-register_form .ps_js-register_first").trigger("focus")},register_info:function(){return u.register_reset(),_.store.store_fetch("info")},register_submit:function(e){var t=_.store.store_fetch("info");if(!t.loading){var i=t.request_num+1;_.store.store_update("info",{loading:!0,request_num:i}),r.register(a.json_serialize(e),{ps_validator_form:e,success:function(){i==t.request_num&&s.modal.close("register","floating_page")},complete:function(){i==t.request_num&&_.store.store_update("info",{loading:!1})}})}},register_validation:function(e,r){var s=e.attr("id"),t=["#"+s+" .ps_js-firstName","#"+s+" .ps_js-lastName","#"+s+" .ps_js-loginName"],i="#"+s+" .ps_js-password_field";return{".ps_js-firstName":{triggers:"blur",prevent:!0,validate:[{as:"required"},{as:"alpha_language"}]},".ps_js-lastName":{triggers:"blur",prevent:!0,validate:[{as:"required"},{as:"alpha_language"}]},".ps_js-loginName":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"loginName",exclude_triggers:["prevent"]},{as:"max_length",type:"loginName"}]},".ps_js-password_field":{triggers:"blur focus",prevent:!0,validate:[{as:"prerequisite",fields:t,is_focus:!0,exclude_triggers:["prevent"]},{as:"required",exclude_triggers:["focus","prevent"]},{as:"not_contain",type:"password",fields:t,exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]},{as:"min_length",type:"password",exclude_triggers:["focus","prevent"]},{as:"alpha_num_symbol",type:"password",fields:t,exclude_triggers:["focus","prevent"]},{as:"no_space"}]},".ps_js-retypePassword":{triggers:"blur focus",prevent:!0,validate:[{as:"prerequisite",fields:[i],is_focus:!0,exclude_triggers:["prevent"]},{as:"required",exclude_triggers:["focus","prevent"]},{as:"same",type:"password",field:i,exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]}]},".ps_js-emailAddress":{triggers:"blur",validate:[{as:"required"},{as:"email"}]},".ps_js-confirmEmailAddress":{triggers:"blur focus",validate:[{as:"prerequisite",fields:["#"+s+" .ps_js-emailAddress"],is_focus:!0},{as:"required",exclude_triggers:["focus"]},{as:"same",type:"email",field:"#"+s+" .ps_js-emailAddress",exclude_triggers:["focus"]}]},".ps_js-mobileNo":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"mobile_number"},{as:"max_length",type:"mobile"},{as:"min_length",type:"mobile",exclude_triggers:["prevent"]}]},".ps_js-bank_select":{triggers:"blur",validate:[{as:"remove"==r.bank_account_info?"null":"required",visible_only:!0},{as:"bank_dropdown"}]},".ps_js-bank_input_segment":{triggers:"blur",validate:[{as:"remove"==r.bank_account_info?"null":"required",type:"multiple",visible_only:!0}]},".ps_js-accountBankName":{triggers:"blur",validate:[{as:"remove"==r.bank_account_info?"null":"required"}]},".ps_js-currency_select":{triggers:"blur",validate:[{as:"required"},{as:"currency_dropdown"}]},".ps_js-promotion":{triggers:"blur",validate:[{as:"required"}]},".ps_js-securityQuestion_select":{triggers:"blur",validate:[{as:"required"},{as:"securityQuestion"}]},".ps_js-yourAnswer":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"max_length",type:"yourAnswer"}]},".ps_js-captcha_input":{triggers:"blur",validate:[{as:"required"}]}}},register_view_data:function(e){r.view_data({success:e},["currency","bank_dropdown","bonus_new_member","securityQuestions","bank_account_config"])}};return{activate:function(i){var l=(u.register_info(),_.form_id);_.form_id++,s.modal.open("register",{modal_class:"register_root",header:t.get("language.account_registration"),body:function(r){e.render(r,"register",{replace:!1,data:{info:u.register_info(),view_data:{},form_id:l,is_loading:!0},computed:{bank_account_config:function(){return this.view_data.bank_account_config||{}},bank_account_info:function(){return this.bank_account_config.bank_account_info||{}}},mounted:function(){var e=this;u.register_view_data(function(r){e.view_data=r,e.is_loading=!1,e.$nextTick(function(){var r=n(e.$el).find(".ps_js-register_form");o.apply(r,{validations:u.register_validation(r,e),success:function(){u.register_submit(r)}})})})}})},bind:{hide:function(){window.location=r.active_main_hash()},shown:function(){a.ready(".ps_js-register_form .ps_js-register_first:visible",function(){n(this).trigger("focus")},n(this))}}},"floating_page")},deactivate:function(e){s.modal.close("register","floating_page")}}});