define("ps_change_credentials",["ps_view","ps_model","ps_validator","ps_store"],function(){"use strict";var e=arguments[0],s=arguments[1],r=arguments[2],t=arguments[3],a={is_page_renderend:!1,form_id:0,store:new t("ps_change_credentials")},i={page_info:function(){return a.store.store_exists("info")||a.store.store_update("info",{loading:!1,request_num:0}),a.store.store_fetch("info")},validations:function(e,s){var r=e.attr("id"),t=["#"+r+" .ps_js-loginName"],a="#"+r+" .ps_js-password_field";return{".ps_js-loginName":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"loginName",exclude_triggers:["prevent"]},{as:"max_length",type:"loginName"}]},".ps_js-current_password":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"max_length",type:"password"}]},".ps_js-password_field":{triggers:"blur focus",prevent:!0,validate:[{as:"prerequisite",fields:t,is_focus:!0,exclude_triggers:["prevent"]},{as:"required",exclude_triggers:["focus","prevent"]},{as:"not_contain",type:"password",fields:t,values:[s.user.firstName,s.user.lastName],exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]},{as:"alpha_num_symbol",type:"password",exclude_triggers:["focus","prevent"]}]},".ps_js-confirm_new_password":{triggers:"blur focus",prevent:!0,validate:[{as:"prerequisite",fields:[a],is_focus:!0,exclude_triggers:["prevent"]},{as:"required",exclude_triggers:["focus","prevent"]},{as:"same",type:"password",field:a,exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]}]}}},view_data:function(e){s.view_data({success:e},["user"])},form_submit:function(e){var r=a.store.store_fetch("info");if(!r.loading){var t=r.request_num+1;a.store.store_update("info",{loading:!0,request_num:t}),s.change_credentials(ps_helper.json_serialize(e),{ps_validator_form:e,success:function(){t==r.request_num&&(window.location="")},complete:function(){t==r.request_num&&a.store.store_update("info",{loading:!1})}})}}};return{activate:function(t,n){var o=i.page_info();if(!a.is_page_rendered){a.is_page_rendered=!0;var _=a.form_id;a.form_id++,e.render($(".ps_js-page_"+n.page),"change_credentials",{replace:!1,data:{hash_info:n,page_info:o,view_data:{},form_id:_},mounted:function(){var e=this;i.view_data(function(t){e.view_data=t,s.update_page_rendered(e.hash_info.page),e.$nextTick(function(){var s=$(e.$el).find(".ps_js-change_credentials_form");r.apply(s,{validations:i.validations(s,e.view_data),success:function(){i.form_submit(s)}}),s.find(".ps_js-change_credentials_reset").on("click",function(){s.trigger("view_components_fullreset")})})})}})}}}});