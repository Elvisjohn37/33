define("ps_account",["ps_view","ps_model","jquery","ps_store","ps_helper","ps_validator"],function(){var e=arguments[0],t=arguments[1],a=arguments[2],s=arguments[3],r=arguments[4],i=arguments[5],n={is_page_rendered:!1,store:new s("ps_account")},_={account_page_info:function(){return n.store.store_exists("info")||n.store.store_update("info",{loaded_hash:[],register_friend_loading:!1,register_friend_handled:!1,deposit_confirmation_loading:!1,deposit_confirmation_handled:!1,withdrawal_request_loading:!1,withdrawal_request_handled:!1,change_password_loading:!1,fund_transfer_loading:!1,fund_transfer_handled:!1,fund_transfer_to:"",reward:[]}),n.store.store_fetch("info")},page_init:function(){var e=this;t.view_data({success:function(a){e.view_data=a,t.update_page_rendered(e.hash_info.page),e.is_init=!0}},["account","user","navigation","configs","wallets_dropdown","bank_account_config","reward"])},active_hash_change:function(e,t){var s=this,i=!r.in_array(e,s.page_info.loaded_hash),o=function(){var n=r.replace_all(t,"#",""),o=_[n];a.isPlainObject(o)&&a.isFunction(o.deactivate)&&o.deactivate.call(s);var d=r.replace_all(e,"#",""),l=_[d];a.isPlainObject(l)&&a.isFunction(l.activate)&&l.activate.call(s,i)};i?(n.store.store_list_push("info","loaded_hash",e),s.$nextTick(function(){o()})):o()},profile:{activate:function(e){var t=this;e&&a(t.$el).find(".ps_js-displayName .ps_js-button_text_trigger").on("click",function(){require(["ps_displayname"],function(e){e.open()})})}},balance:{activate:function(e){var t=this;e||a(t.$el).find(".ps_js-account_balance .ps_js-usedbalance_root").trigger("view_components_refresh")}},register_friend:{activate:function(e){var t=this;e&&t.$watch("view_data.user.derived_is_transactable",function(){n.store.store_update("info",{register_friend_handled:!1}),"#register_friend"===t.active_main_hash&&_.register_friend.update_handlers(t)}),_.register_friend.update_handlers(t)},update_handlers:function(e){var s=a(e.$el).find(".ps_js-register_friend_form");s.length>0&&(e.page_info.register_friend_handled||(n.store.store_update("info",{register_friend_handled:!0}),i.apply(s,{validations:_.register_friend.validations(),success:function(){n.store.store_update("info",{register_friend_loading:!0}),t.register_friend(r.json_serialize(s),{ps_validator_form:s,success:function(){s.trigger("view_components_fullreset")},complete:function(){n.store.store_update("info",{register_friend_loading:!1})}})}}),s.find(".ps_js-register_friend_reset").on("click",function(){s.trigger("view_components_fullreset")})),s.trigger("view_components_fullreset"))},validations:function(){return{".ps_js-firstName":{triggers:"blur",prevent:!0,validate:[{as:"required"},{as:"alpha_language"}]},".ps_js-lastName":{triggers:"blur",prevent:!0,validate:[{as:"required"},{as:"alpha_language"}]},".ps_js-bank_select":{triggers:"blur",validate:[{as:"required"},{as:"bank_dropdown"}]},".ps_js-bank_input_segment":{triggers:"blur",validate:[{as:"required",type:"multiple",visible_only:!0}]},".ps_js-accountBankName":{triggers:"blur",validate:[{as:"required"}]},".ps_js-emailAddress":{triggers:"blur",validate:[{as:"required"},{as:"email"}]},".ps_js-mobileNo":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"mobile_number"},{as:"max_length",type:"mobile"},{as:"min_length",type:"mobile",exclude_triggers:["prevent"]}]}}}},deposit_confirmation:{activate:function(e){var t=this;e&&t.$watch("view_data.user.derived_is_transactable",function(){n.store.store_update("info",{deposit_confirmation_handled:!1}),"#deposit_confirmation"===t.active_main_hash&&_.deposit_confirmation.update_handlers(t)}),_.deposit_confirmation.update_handlers(t)},update_handlers:function(e){var s=a(e.$el).find(".ps_js-deposit_confirmation_form");s.length>0&&(e.page_info.deposit_confirmation_handled||(n.store.store_update("info",{deposit_confirmation_handled:!0}),i.apply(s,{validations:_.deposit_confirmation.validations(),success:function(){n.store.store_update("info",{deposit_confirmation_loading:!0});var e=s.find(":visible");t.deposit_confirmation(r.json_serialize(e),{ps_validator_form:s,success:function(e){s.trigger("view_components_fullreset")},complete:function(){n.store.store_update("info",{deposit_confirmation_loading:!1})}})}}),s.find(".ps_js-deposit_confirmation_reset").on("click",function(){s.trigger("view_components_fullreset")})),s.trigger("view_components_fullreset"))},validations:function(){return{".ps_js-bank_select":{triggers:"blur",validate:[{as:"required"},{as:"bank_dropdown"}]},".ps_js-bank_input_segment":{triggers:"blur",validate:[{as:"required",type:"multiple",visible_only:!0}]},".ps_js-accountBankName":{triggers:"blur",validate:[{as:"required"}]},".ps_js-money_input":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"money"}]},".ps_js-captcha_input":{triggers:"blur",validate:[{as:"required",visible_only:!0}]}}}},withdrawal_request:{activate:function(e){var t=this;e&&t.$watch("view_data.user.derived_is_transactable",function(){n.store.store_update("info",{withdrawal_request_handled:!1}),"#withdrawal_request"===t.active_main_hash&&_.withdrawal_request.update_handlers(t)}),_.withdrawal_request.update_handlers(t)},update_handlers:function(e){var s=a(e.$el).find(".ps_js-withdrawal_request_form");s.length>0&&(e.page_info.withdrawal_request_handled||(n.store.store_update("info",{withdrawal_request_handled:!0}),i.apply(s,{validations:_.withdrawal_request.validations(),success:function(){n.store.store_update("info",{withdrawal_request_loading:!0});var e=s.find(":visible");t.withdrawal_request(r.json_serialize(e),{ps_validator_form:s,success:function(e){s.trigger("view_components_fullreset")},complete:function(){n.store.store_update("info",{withdrawal_request_loading:!1})}})}}),s.find(".ps_js-withdrawal_request_reset").on("click",function(){s.trigger("view_components_fullreset")})),s.trigger("view_components_fullreset"))},validations:function(){return{".ps_js-password":{triggers:"blur",validate:[{as:"required"}]},".ps_js-amount .ps_js-money_input":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"money"}]},".ps_js-captcha_input":{triggers:"blur",validate:[{as:"required",visible_only:!0}]}}}},change_password:{activate:function(e){var s=this,o=a(s.$el).find("#ps_js-change_password");e&&(i.apply(o,{validations:_.change_password.validations(s),success:function(){n.store.store_update("info",{change_password_loading:!0}),t.change_password(r.json_serialize(o),{ps_validator_form:o,success:function(e){o.trigger("view_components_fullreset")},complete:function(){n.store.store_update("info",{change_password_loading:!1})}})}}),o.find(".ps_js-change_password_reset").on("click",function(){o.trigger("view_components_fullreset")})),o.trigger("view_components_fullreset")},validations:function(e){return{".ps_js-current_password":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"max_length",type:"password"}]},".ps_js-password_field":{triggers:"blur focus",prevent:!0,validate:[{as:"required",exclude_triggers:["focus","prevent"]},{as:"not_contain",type:"password",values:[e.view_data.user.firstName,e.view_data.user.lastName,e.view_data.user.loginName],exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]},{as:"alpha_num_symbol",type:"password",exclude_triggers:["focus","prevent"]}]},".ps_js-confirm_new_password":{triggers:"blur focus",prevent:!0,validate:[{as:"prerequisite",fields:["#ps_js-change_password .ps_js-password_field"],is_focus:!0,exclude_triggers:["prevent"]},{as:"required",exclude_triggers:["focus","prevent"]},{as:"same",type:"password",field:"#ps_js-change_password .ps_js-password_field",exclude_triggers:["focus","prevent"]},{as:"max_length",type:"password",exclude_triggers:["focus"]}]}}}},fund_transfer:{activate:function(e){var t=this;e&&t.$watch("view_data.user.derived_is_transactable",function(){n.store.store_update("info",{fund_transfer_handled:!1}),"#fund_transfer"===t.active_main_hash&&_.fund_transfer.update_handlers(t)}),_.fund_transfer.update_handlers(t)},update_handlers:function(e){var t=a(e.$el).find(".ps_js-fund_transfer_form");if(t.length>0){if(!e.page_info.fund_transfer_handled){n.store.store_update("info",{fund_transfer_handled:!0}),i.apply(t,{validations:_.fund_transfer.validations(),success:function(){_.fund_transfer.submit(e,t)}}),t.find(".ps_js-fund_transfer_reset").on("click",function(){t.trigger("view_components_fullreset")});var s=t.find(".ps_js-fund_to_wallet .ps_js-wallet_select");s.on("change",function(){n.store.store_update("info",{fund_transfer_to:a(this).val()})}),t.on("view_components_postreset",function(){s.val(e.default_fund_to),s.trigger("change")})}t.trigger("view_components_fullreset")}},submit:function(e,s){n.store.store_update("info",{fund_transfer_loading:!0});var i=s.find(":visible");t.fund_transfer(r.json_serialize(i),{ps_validator_form:s,success:function(t){if(s.trigger("view_components_fullreset"),"house"==e.page_info.fund_transfer_to)var r=s.find(".ps_js-fund_from_wallet .ps_js-wallet_select").val();else var r=s.find(".ps_js-fund_to_wallet .ps_js-wallet_select").val();a(e.$el).find(".ps_js-account_fund_transfer .ps_js-usedbalance_wallets").trigger("view_components_refresh",r)},complete:function(){n.store.store_update("info",{fund_transfer_loading:!1})}})},validations:function(){return{".ps_js-wallet_select":{triggers:"blur",validate:[{as:"required",exclude_triggers:["focus"]}]},".ps_js-money_input":{triggers:"blur",prevent:!0,validate:[{as:"required",exclude_triggers:["prevent"]},{as:"money"}]},".ps_js-captcha_input":{triggers:"blur",validate:[{as:"required",visible_only:!0}]}}}},reward:{activate:function(e){var t=this;e&&n.store.store_update("info",{reward:t.view_data.reward})}}};return{activate:function(t,s){var r=_.account_page_info();n.is_page_rendered||(n.is_page_rendered=!0,e.render(a(".ps_js-page_"+s.page),"account",{replace:!1,computed:{page_navigation_data:function(){return this.view_data.navigation.pages[this.hash_info.page]},active_main_hash:function(){var e=this;return e.is_init?e.page_navigation_data.active_main_hash:""},displayName_editable:function(){var e=this;return!!e.is_init&&1!=e.view_data.user.displayNameStatus},fund_from_type:function(){return"house"==this.page_info.fund_transfer_to?"nonhouse":"house"},default_fund_to:function(){var e=this,t=Object.keys(e.view_data.wallets_dropdown);return t.length>1?t[1]:null},bank_account_config:function(){return this.view_data.bank_account_config||{}},bank_account_info:function(){return this.bank_account_config.bank_account_info||{}}},watch:{active_main_hash:_.active_hash_change},data:{hash_info:s,page_info:r,view_data:{},is_init:!1},mounted:_.page_init}))}}});